{"version":3,"sources":["../node_modules/dayjs/dayjs.min.js","utils.js","aqi-calculator.js"],"names":["BANDS","label","color","range","pm25","pm10","so2","no","nox","no2","o3","co","aqi","HOUR_DIFF","module","exports","dayjs","require","calculateSubIndex","arr","pollutant","Object","keys","includes","now","hourDiff","filtered","filter","datetime","value","diff","length","mean","reduce","acc","index","findIndex","lastIndex","aqiBase","pollutantBase","aqiLo","aqiHi","pollutantLo","calculateAQI","Array","isArray","pollutantArr","val","map","key","obj","subIndexes","nAQI","Math","max","round"],"mappings":"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","file":"aqi-calculator.js","sourceRoot":"../src","sourcesContent":["!function(t,n){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=n():\"function\"==typeof define&&define.amd?define(n):t.dayjs=n()}(this,function(){\"use strict\";var t=\"millisecond\",n=\"second\",e=\"minute\",r=\"hour\",i=\"day\",s=\"week\",u=\"month\",o=\"quarter\",a=\"year\",h=/^(\\d{4})-?(\\d{1,2})-?(\\d{0,2})[^0-9]*(\\d{1,2})?:?(\\d{1,2})?:?(\\d{1,2})?.?(\\d{1,3})?$/,f=/\\[([^\\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,c=function(t,n,e){var r=String(t);return!r||r.length>=n?t:\"\"+Array(n+1-r.length).join(e)+t},d={s:c,z:function(t){var n=-t.utcOffset(),e=Math.abs(n),r=Math.floor(e/60),i=e%60;return(n<=0?\"+\":\"-\")+c(r,2,\"0\")+\":\"+c(i,2,\"0\")},m:function(t,n){var e=12*(n.year()-t.year())+(n.month()-t.month()),r=t.clone().add(e,u),i=n-r<0,s=t.clone().add(e+(i?-1:1),u);return Number(-(e+(n-r)/(i?r-s:s-r))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(h){return{M:u,y:a,w:s,d:i,D:\"date\",h:r,m:e,s:n,ms:t,Q:o}[h]||String(h||\"\").toLowerCase().replace(/s$/,\"\")},u:function(t){return void 0===t}},$={name:\"en\",weekdays:\"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday\".split(\"_\"),months:\"January_February_March_April_May_June_July_August_September_October_November_December\".split(\"_\")},l=\"en\",m={};m[l]=$;var y=function(t){return t instanceof v},M=function(t,n,e){var r;if(!t)return l;if(\"string\"==typeof t)m[t]&&(r=t),n&&(m[t]=n,r=t);else{var i=t.name;m[i]=t,r=i}return!e&&r&&(l=r),r||!e&&l},g=function(t,n,e){if(y(t))return t.clone();var r=n?\"string\"==typeof n?{format:n,pl:e}:n:{};return r.date=t,new v(r)},D=d;D.l=M,D.i=y,D.w=function(t,n){return g(t,{locale:n.$L,utc:n.$u,$offset:n.$offset})};var v=function(){function c(t){this.$L=this.$L||M(t.locale,null,!0),this.parse(t)}var d=c.prototype;return d.parse=function(t){this.$d=function(t){var n=t.date,e=t.utc;if(null===n)return new Date(NaN);if(D.u(n))return new Date;if(n instanceof Date)return new Date(n);if(\"string\"==typeof n&&!/Z$/i.test(n)){var r=n.match(h);if(r)return e?new Date(Date.UTC(r[1],r[2]-1,r[3]||1,r[4]||0,r[5]||0,r[6]||0,r[7]||0)):new Date(r[1],r[2]-1,r[3]||1,r[4]||0,r[5]||0,r[6]||0,r[7]||0)}return new Date(n)}(t),this.init()},d.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},d.$utils=function(){return D},d.isValid=function(){return!(\"Invalid Date\"===this.$d.toString())},d.isSame=function(t,n){var e=g(t);return this.startOf(n)<=e&&e<=this.endOf(n)},d.isAfter=function(t,n){return g(t)<this.startOf(n)},d.isBefore=function(t,n){return this.endOf(n)<g(t)},d.$g=function(t,n,e){return D.u(t)?this[n]:this.set(e,t)},d.year=function(t){return this.$g(t,\"$y\",a)},d.month=function(t){return this.$g(t,\"$M\",u)},d.day=function(t){return this.$g(t,\"$W\",i)},d.date=function(t){return this.$g(t,\"$D\",\"date\")},d.hour=function(t){return this.$g(t,\"$H\",r)},d.minute=function(t){return this.$g(t,\"$m\",e)},d.second=function(t){return this.$g(t,\"$s\",n)},d.millisecond=function(n){return this.$g(n,\"$ms\",t)},d.unix=function(){return Math.floor(this.valueOf()/1e3)},d.valueOf=function(){return this.$d.getTime()},d.startOf=function(t,o){var h=this,f=!!D.u(o)||o,c=D.p(t),d=function(t,n){var e=D.w(h.$u?Date.UTC(h.$y,n,t):new Date(h.$y,n,t),h);return f?e:e.endOf(i)},$=function(t,n){return D.w(h.toDate()[t].apply(h.toDate(\"s\"),(f?[0,0,0,0]:[23,59,59,999]).slice(n)),h)},l=this.$W,m=this.$M,y=this.$D,M=\"set\"+(this.$u?\"UTC\":\"\");switch(c){case a:return f?d(1,0):d(31,11);case u:return f?d(1,m):d(0,m+1);case s:var g=this.$locale().weekStart||0,v=(l<g?l+7:l)-g;return d(f?y-v:y+(6-v),m);case i:case\"date\":return $(M+\"Hours\",0);case r:return $(M+\"Minutes\",1);case e:return $(M+\"Seconds\",2);case n:return $(M+\"Milliseconds\",3);default:return this.clone()}},d.endOf=function(t){return this.startOf(t,!1)},d.$set=function(s,o){var h,f=D.p(s),c=\"set\"+(this.$u?\"UTC\":\"\"),d=(h={},h[i]=c+\"Date\",h.date=c+\"Date\",h[u]=c+\"Month\",h[a]=c+\"FullYear\",h[r]=c+\"Hours\",h[e]=c+\"Minutes\",h[n]=c+\"Seconds\",h[t]=c+\"Milliseconds\",h)[f],$=f===i?this.$D+(o-this.$W):o;if(f===u||f===a){var l=this.clone().set(\"date\",1);l.$d[d]($),l.init(),this.$d=l.set(\"date\",Math.min(this.$D,l.daysInMonth())).toDate()}else d&&this.$d[d]($);return this.init(),this},d.set=function(t,n){return this.clone().$set(t,n)},d.get=function(t){return this[D.p(t)]()},d.add=function(t,o){var h,f=this;t=Number(t);var c=D.p(o),d=function(n){var e=g(f);return D.w(e.date(e.date()+Math.round(n*t)),f)};if(c===u)return this.set(u,this.$M+t);if(c===a)return this.set(a,this.$y+t);if(c===i)return d(1);if(c===s)return d(7);var $=(h={},h[e]=6e4,h[r]=36e5,h[n]=1e3,h)[c]||1,l=this.$d.getTime()+t*$;return D.w(l,this)},d.subtract=function(t,n){return this.add(-1*t,n)},d.format=function(t){var n=this;if(!this.isValid())return\"Invalid Date\";var e=t||\"YYYY-MM-DDTHH:mm:ssZ\",r=D.z(this),i=this.$locale(),s=this.$H,u=this.$m,o=this.$M,a=i.weekdays,h=i.months,c=function(t,r,i,s){return t&&(t[r]||t(n,e))||i[r].substr(0,s)},d=function(t){return D.s(s%12||12,t,\"0\")},$=i.meridiem||function(t,n,e){var r=t<12?\"AM\":\"PM\";return e?r.toLowerCase():r},l={YY:String(this.$y).slice(-2),YYYY:this.$y,M:o+1,MM:D.s(o+1,2,\"0\"),MMM:c(i.monthsShort,o,h,3),MMMM:h[o]||h(this,e),D:this.$D,DD:D.s(this.$D,2,\"0\"),d:String(this.$W),dd:c(i.weekdaysMin,this.$W,a,2),ddd:c(i.weekdaysShort,this.$W,a,3),dddd:a[this.$W],H:String(s),HH:D.s(s,2,\"0\"),h:d(1),hh:d(2),a:$(s,u,!0),A:$(s,u,!1),m:String(u),mm:D.s(u,2,\"0\"),s:String(this.$s),ss:D.s(this.$s,2,\"0\"),SSS:D.s(this.$ms,3,\"0\"),Z:r};return e.replace(f,function(t,n){return n||l[t]||r.replace(\":\",\"\")})},d.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},d.diff=function(t,h,f){var c,d=D.p(h),$=g(t),l=6e4*($.utcOffset()-this.utcOffset()),m=this-$,y=D.m(this,$);return y=(c={},c[a]=y/12,c[u]=y,c[o]=y/3,c[s]=(m-l)/6048e5,c[i]=(m-l)/864e5,c[r]=m/36e5,c[e]=m/6e4,c[n]=m/1e3,c)[d]||m,f?y:D.a(y)},d.daysInMonth=function(){return this.endOf(u).$D},d.$locale=function(){return m[this.$L]},d.locale=function(t,n){if(!t)return this.$L;var e=this.clone(),r=M(t,n,!0);return r&&(e.$L=r),e},d.clone=function(){return D.w(this.$d,this)},d.toDate=function(){return new Date(this.valueOf())},d.toJSON=function(){return this.isValid()?this.toISOString():null},d.toISOString=function(){return this.$d.toISOString()},d.toString=function(){return this.$d.toUTCString()},c}();return g.prototype=v.prototype,g.extend=function(t,n){return t(n,v,g),g},g.locale=M,g.isDayjs=y,g.unix=function(t){return g(1e3*t)},g.en=m[l],g.Ls=m,g});\n","const BANDS = [\n  {\n    label: \"Good\",\n    color: \"#009900\",\n    range: {\n      pm25: [0, 30],\n      pm10: [0, 50],\n      so2: [0, 40],\n      no: [0, 40],\n      nox: [0, 40],\n      no2: [0, 40],\n      o3: [0, 50],\n      co: [0, 1],\n      aqi: [0, 50],\n    },\n  },\n  {\n    label: \"Satisfactory\",\n    color: \"#59B300\",\n    range: {\n      pm25: [30, 60],\n      pm10: [50, 100],\n      so2: [40, 80],\n      no: [40, 80],\n      nox: [40, 80],\n      no2: [40, 80],\n      o3: [50, 100],\n      co: [1, 2],\n      aqi: [50, 100],\n    },\n  },\n  {\n    label: \"Moderately Polluted\",\n    color: \"#DFDF31\",\n    range: {\n      pm25: [60, 90],\n      pm10: [100, 250],\n      so2: [80, 380],\n      no: [80, 180],\n      nox: [80, 180],\n      no2: [80, 180],\n      o3: [100, 168],\n      co: [2, 10],\n      aqi: [100, 200],\n    },\n  },\n  {\n    label: \"Poor\",\n    color: \"#E68A00\",\n    range: {\n      pm25: [90, 120],\n      pm10: [250, 350],\n      so2: [380, 800],\n      no: [180, 280],\n      nox: [180, 280],\n      no2: [180, 280],\n      o3: [168, 280],\n      co: [10, 17],\n      aqi: [200, 300],\n    },\n  },\n  {\n    label: \"Very Poor\",\n    color: \"#E82C0C\",\n    range: {\n      pm25: [120, 250],\n      pm10: [350, 430],\n      so2: [800, 1600],\n      no: [280, 400],\n      nox: [280, 400],\n      no2: [280, 400],\n      o3: [280, 400],\n      co: [17, 34],\n      aqi: [300, 400],\n    },\n  },\n  {\n    label: \"Severe\",\n    color: \"#A52A2A\",\n    range: {\n      pm25: [250, 1000],\n      pm10: [430, 1000],\n      so2: [1600, 2000],\n      no: [400, 1000],\n      nox: [400, 1000],\n      no2: [400, 1000],\n      o3: [400, 1000],\n      co: [34, 50],\n      aqi: [400, 500],\n    },\n  },\n];\n\nconst HOUR_DIFF = {\n  pm25: 24,\n  pm10: 24,\n  so2: 24,\n  nox: 24,\n  o3: 8,\n  co: 8,\n};\n\nmodule.exports = { BANDS, HOUR_DIFF };\n","const dayjs = require(\"dayjs\");\nconst { BANDS, HOUR_DIFF } = require(\"./utils\");\n\nconst calculateSubIndex = (arr = [], pollutant) => {\n  // If not a known pollutant\n  if (!Object.keys(HOUR_DIFF).includes(pollutant)) return 0;\n\n  // FIlter the values based on hours and null check\n  const now = dayjs();\n  // Hour diff specific to pollutant\n  const hourDiff = HOUR_DIFF[pollutant];\n  const filtered = arr.filter(\n    ({ datetime, value }) =>\n      value && now.diff(dayjs(datetime), \"hours\") < hourDiff\n  );\n\n  // If no values left, aqi is considered 0\n  if (filtered.length <= 0) return 0;\n\n  // Average out the values\n  const mean =\n    filtered.reduce((acc, { value }) => acc + value, 0) / filtered.length;\n\n  // Find which aqi bands it belongs\n  const index = BANDS.findIndex(({ range }) => range[pollutant][1] >= mean);\n\n  // Edge Case\n  // if it exceeds the set bands\n  if (index <= 0) {\n    const lastIndex = BANDS.length - 1;\n\n    const aqiBase = BANDS[lastIndex].range.aqi[1];\n    const pollutantBase = BANDS[lastIndex].range[pollutant][1];\n\n    const aqi = (aqiBase / pollutantBase) * (mean - pollutantBase) + aqiBase;\n    return aqi;\n  }\n\n  const [aqiLo, aqiHi] = BANDS[index].range.aqi;\n\n  const [pollutantLo, pollutantHi] = BANDS[index].range[pollutant];\n\n  // this is the basically the line equation where we take the ratio of slopes of\n  // the two lines. two lines representing linear relation between subIndex and concentrations\n  // Linear algebra 101\n  const aqi =\n    ((aqiHi - aqiLo) / (pollutantHi - pollutantLo)) * (mean - pollutantLo) +\n    aqiLo;\n  return aqi;\n};\n\nconst calculateAQI = (arr) => {\n  //validation\n  if (!Array.isArray(arr) || arr.length === 0) return 0;\n\n  // Get the data in proper format\n  const pollutantArr = arr.reduce((acc, val) => {\n    Object.keys(HOUR_DIFF).map((key) => {\n      const obj = {\n        datetime: val.datetime,\n        value: val[key],\n      };\n      acc[key] = acc[key] ? [...acc[key], obj] : [obj];\n    });\n    return acc;\n  }, {});\n\n  // Calculate subIndex of each pollutant\n  const subIndexes = Object.keys(pollutantArr).map((key) =>\n    calculateSubIndex(pollutantArr[key], key)\n  );\n\n  // The good stuff\n  const nAQI = Math.max(...subIndexes);\n  return Math.round(nAQI);\n};\n\nmodule.exports = calculateAQI;\n"]}
